slug: network-monitoring
title: Network Monitoring
sequence_order: 16
estimated_minutes: 5
difficulty: medium
content_md: |
  # Network Monitoring

  Monitoring network health, performance, and security.

  ## What to Monitor

  ### Availability
  - Server uptime
  - Service health
  - Response times

  ### Performance
  - Bandwidth usage
  - Latency
  - Packet loss
  - Throughput

  ### Security
  - Unusual traffic patterns
  - Failed login attempts
  - Port scans

  ## Essential Monitoring Commands

  ### Bandwidth and Traffic

  ```bash
  # Real-time bandwidth per interface
  iftop -i eth0

  # Network statistics
  vnstat -l  # Live monitoring
  vnstat -d  # Daily statistics

  # Bandwidth by process
  nethogs eth0

  # Connection statistics
  ss -s
  ```

  ### Latency and Connectivity

  ```bash
  # Continuous ping with statistics
  ping -c 100 google.com | tail -3

  # MTR - combined ping and traceroute
  mtr google.com
  mtr -r -c 10 google.com  # Report mode

  # Check specific port response time
  time nc -zv example.com 443
  ```

  ### Connection Monitoring

  ```bash
  # Active connections
  ss -tunapl

  # Connections by state
  ss -s

  # Top connections by host
  netstat -ntu | awk '{print $5}' | cut -d: -f1 | sort | uniq -c | sort -rn | head

  # Watch connections in real-time
  watch -n 1 'ss -tunapl | wc -l'
  ```

  ## SNMP Monitoring

  Simple Network Management Protocol for device monitoring:

  ```bash
  # Query SNMP device
  snmpwalk -v2c -c public 192.168.1.1

  # Get specific OID (system uptime)
  snmpget -v2c -c public 192.168.1.1 1.3.6.1.2.1.1.3.0
  ```

  ## Packet Analysis

  ```bash
  # Capture HTTP traffic
  sudo tcpdump -i eth0 port 80 -A

  # Capture and save
  sudo tcpdump -i eth0 -w capture.pcap

  # Read capture file
  tcpdump -r capture.pcap

  # Filter by host
  sudo tcpdump -i eth0 host 192.168.1.100

  # Show packet contents
  sudo tcpdump -i eth0 -X port 443
  ```

  ## Monitoring Tools

  ### Command Line
  | Tool | Purpose |
  |------|---------|
  | **iftop** | Bandwidth by connection |
  | **nethogs** | Bandwidth by process |
  | **vnstat** | Traffic statistics |
  | **mtr** | Network path analysis |
  | **tcpdump** | Packet capture |
  | **ss/netstat** | Connection info |

  ### Graphical/Web
  | Tool | Purpose |
  |------|---------|
  | **Wireshark** | Packet analysis |
  | **Nagios** | Infrastructure monitoring |
  | **Zabbix** | Full-stack monitoring |
  | **Prometheus** | Metrics collection |
  | **Grafana** | Visualization |

  ## Setting Up Alerts

  Monitor and alert on:

  ```
  Critical Alerts:
  - Server down (ping fails)
  - Disk > 90% full
  - CPU > 95% for 5+ minutes
  - Service not responding

  Warning Alerts:
  - High latency (> 200ms)
  - Packet loss > 1%
  - Unusual traffic spike
  - Certificate expiring soon
  ```

  ## Quick Health Check Script

  ```bash
  #!/bin/bash
  # Quick network health check

  echo "=== Interface Status ==="
  ip -br link show

  echo -e "\n=== IP Addresses ==="
  ip -br addr show

  echo -e "\n=== Routing ==="
  ip route show

  echo -e "\n=== DNS Servers ==="
  cat /etc/resolv.conf | grep nameserver

  echo -e "\n=== Active Connections ==="
  ss -s

  echo -e "\n=== Listening Ports ==="
  ss -tuln | head -20

  echo -e "\n=== Internet Connectivity ==="
  ping -c 3 8.8.8.8

  echo -e "\n=== DNS Resolution ==="
  nslookup google.com
  ```

exercises:
  - type: mcq
    sequence_order: 1
    question: Which tool shows bandwidth usage per process?
    options:
      - iftop
      - nethogs
      - netstat
      - ping
    correct_answer_index: 1
    explanation: nethogs shows bandwidth usage per process, helping identify which applications are using network resources.

  - type: mcq
    sequence_order: 2
    question: What does mtr combine?
    options:
      - ping and netstat
      - ping and traceroute
      - tcpdump and wireshark
      - curl and wget
    correct_answer_index: 1
    explanation: mtr (My TraceRoute) combines ping and traceroute, showing continuous statistics for each hop to the destination.

  - type: mcq
    sequence_order: 3
    question: Which command captures network packets?
    options:
      - netstat
      - ss
      - tcpdump
      - iftop
    correct_answer_index: 2
    explanation: tcpdump captures raw network packets for analysis. Use Wireshark for graphical packet analysis.

  - type: mcq
    sequence_order: 4
    question: What is SNMP used for?
    options:
      - Sending emails
      - Monitoring network devices
      - Encrypting traffic
      - Routing packets
    correct_answer_index: 1
    explanation: SNMP (Simple Network Management Protocol) is used to monitor and manage network devices like routers, switches, and servers.

  - type: mcq
    sequence_order: 5
    question: What should trigger a critical alert?
    options:
      - Disk at 50% capacity
      - Server ping fails
      - Normal traffic levels
      - User logged in
    correct_answer_index: 1
    explanation: Critical alerts should be for situations requiring immediate action, like server down, service not responding, or resources exhausted.

  - type: terminal
    sequence_order: 6
    description: Show network interface status using ip command
    command: ip -br link show
    timeout_sec: 5
    validation:
      exit_code: 0
    hints:
      - Use 'ip -br link show' for a brief summary
      - The output shows interface name and status (UP/DOWN)

objectives:
  - Monitor network performance and availability
  - Use command-line monitoring tools
  - Set up meaningful alerts
next_recommended: []

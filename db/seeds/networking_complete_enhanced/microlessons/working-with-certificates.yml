slug: working-with-certificates
title: Working with Certificates
sequence_order: 4
estimated_minutes: 2
difficulty: easy
content_md: "# Working with Certificates \U0001F680\n\n# Working with Certificates\n\
  \n    ## Generating Self-Signed Certificates\n\n    ### Quick Self-Signed Certificate\n\
  \    ```bash\n    # Generate private key and certificate in one command\n    openssl\
  \ req -x509 -newkey rsa:4096 -nodes \\\\\n      -keyout server.key \\\\\n      -out\
  \ server.crt \\\\\n      -days 365 \\\\\n      -subj \"/CN=localhost\"\n    ```\n\
  \n    ### Step-by-Step Certificate Generation\n\n    ```bash\n    # 1. Generate\
  \ private key\n    openssl genrsa -out server.key 2048\n\n    # 2. Create certificate\
  \ signing request (CSR)\n    openssl req -new -key server.key -out server.csr \\\
  \\\n      -subj \"/C=US/ST=CA/L=SF/O=MyOrg/CN=example.com\"\n\n    # 3. Self-sign\
  \ the certificate\n    openssl x509 -req -days 365 \\\\\n      -in server.csr \\\
  \\\n      -signkey server.key \\\\\n      -out server.crt\n    ```\n\n    ## Inspecting\
  \ Certificates\n\n    ### View Certificate Details\n    ```bash\n    # View certificate\
  \ contents\n    openssl x509 -in server.crt -text -noout\n\n    # Check certificate\
  \ dates\n    openssl x509 -in server.crt -noout -dates\n\n    # View subject and\
  \ issuer\n    openssl x509 -in server.crt -noout -subject -issuer\n\n    # Check\
  \ certificate fingerprint\n    openssl x509 -in server.crt -noout -fingerprint -sha256\n\
  \    ```\n\n    ### View Remote Server Certificate\n    ```bash\n    # Check server's\
  \ certificate\n    openssl s_client -connect example.com:443 -servername example.com\n\
  \n    # Get certificate expiry\n    echo | openssl s_client -connect example.com:443\
  \ 2>/dev/null | \\\\\n      openssl x509 -noout -dates\n    ```\n\n    ## Certificate\
  \ Formats\n\n    ### PEM (Privacy Enhanced Mail)\n    ```\n    -----BEGIN CERTIFICATE-----\n\
  \    Base64 encoded data\n    -----END CERTIFICATE-----\n    ```\n    - Most common\
  \ format\n    - Text-based\n    - Extensions: `.pem`, `.crt`, `.cer`, `.key`\n\n\
  \    ### DER (Distinguished Encoding Rules)\n    - Binary format\n    - Extensions:\
  \ `.der`, `.cer`\n\n    ```bash\n    # Convert PEM to DER\n    openssl x509 -in\
  \ cert.pem -outform DER -out cert.der\n\n    # Convert DER to PEM\n    openssl x509\
  \ -in cert.der -inform DER -out cert.pem\n    ```\n\n    ### PKCS#12 / PFX\n   \
  \ - Bundle: certificate + private key + chain\n    - Password protected\n    - Extension:\
  \ `.p12`, `.pfx`\n\n    ```bash\n    # Create PKCS#12 bundle\n    openssl pkcs12\
  \ -export \\\\\n      -in server.crt \\\\\n      -inkey server.key \\\\\n      -out\
  \ server.p12 \\\\\n      -name \"My Server Cert\"\n\n    # Extract from PKCS#12\n\
  \    openssl pkcs12 -in server.p12 -out server.pem -nodes\n    ```\n\n    ## Testing\
  \ HTTPS\n\n    ### Using curl\n    ```bash\n    # Test HTTPS endpoint\n    curl\
  \ https://example.com\n\n    # Show certificate details\n    curl -vI https://example.com\n\
  \n    # Ignore certificate validation (testing only!)\n    curl -k https://localhost:8443\n\
  \n    # Use specific CA certificate\n    curl --cacert custom-ca.crt https://internal.example.com\n\
  \    ```\n\n    ### Using wget\n    ```bash\n    # Download over HTTPS\n    wget\
  \ https://example.com/file.txt\n\n    # Ignore certificate (testing only!)\n   \
  \ wget --no-check-certificate https://localhost:8443/file.txt\n    ```\n\n    ##\
  \ Common Certificate Errors\n\n    ### 1. Certificate Expired\n    ```\n    ERROR:\
  \ certificate has expired\n    ```\n    - Certificate validity period has passed\n\
  \    - Renew certificate\n\n    ### 2. Hostname Mismatch\n    ```\n    ERROR: certificate\
  \ subject name does not match target host name\n    ```\n    - Certificate CN/SAN\
  \ doesn't match domain\n    - Need new certificate for correct domain\n\n    ###\
  \ 3. Self-Signed Certificate\n    ```\n    ERROR: self signed certificate\n    ```\n\
  \    - Certificate not signed by trusted CA\n    - Add certificate to trust store,\
  \ or use --insecure (dev only)\n\n    ### 4. Untrusted CA\n    ```\n    ERROR: unable\
  \ to get local issuer certificate\n    ```\n    - Issuing CA not in trust store\n\
  \    - Add CA certificate to system trust store\n\n    ## Certificate Best Practices\n\
  \n    1. **Use 2048-bit or higher** RSA keys (or Ed25519)\n    2. **Keep private\
  \ keys secure** - never commit to git, use 600 permissions\n    3. **Use strong\
  \ Subject Alternative Names (SANs)** for multiple domains\n    4. **Set appropriate\
  \ validity periods** (90 days recommended with auto-renewal)\n    5. **Use Let's\
  \ Encrypt** for public-facing services\n    6. **Monitor expiration dates** - automate\
  \ renewals\n    7. **Use TLS 1.2 or 1.3 only** - disable older versions"
exercises:
- type: mcq
  sequence_order: 1
  question: What is a Certificate Authority (CA) in the context of TLS certificates?
  options:
  - A trusted third party that issues and signs digital certificates
  - A server that hosts websites
  - A type of encryption algorithm
  - A database of user credentials
  correct_answer_index: 0
  explanation: A CA is a trusted entity that verifies the identity of certificate requesters and issues signed certificates. Browsers and systems have a list of trusted root CAs. When a CA signs a certificate, it's vouching that the certificate owner is who they claim to be.
- type: mcq
  sequence_order: 2
  question: What is the most common certificate format used on Linux/Unix systems?
  options:
  - DER
  - PKCS#12
  - PEM
  - P7B
  correct_answer_index: 2
  explanation: PEM (Privacy Enhanced Mail) is the most common format, using Base64 encoding with BEGIN/END markers. It's text-based and human-readable, typically with .pem, .crt, or .cer extensions.
- type: mcq
  sequence_order: 3
  question: What does a PKCS#12 (.p12 or .pfx) file contain?
  options:
  - Only the certificate
  - Only the private key
  - Certificate, private key, and optionally the certificate chain (all in one file)
  - Just the public key
  correct_answer_index: 2
  explanation: PKCS#12 bundles the certificate, private key, and optionally the certificate chain into a single password-protected file. It's commonly used for importing/exporting certificates with their keys.
- type: mcq
  sequence_order: 4
  question: Which command generates a self-signed certificate valid for 365 days?
  options:
  - openssl x509 -new -out cert.pem
  - openssl req -x509 -newkey rsa:2048 -keyout key.pem -out cert.pem -days 365
  - openssl genrsa -out key.pem 2048
  - openssl ca -sign cert.csr
  correct_answer_index: 1
  explanation: The 'openssl req -x509' command creates a self-signed certificate. The -newkey flag generates a new key, -keyout specifies the key file, -out specifies the certificate file, and -days sets validity period.
- type: mcq
  sequence_order: 5
  question: What does the command 'openssl x509 -in cert.pem -text -noout' do?
  options:
  - Creates a new certificate
  - Displays the certificate contents in human-readable format
  - Converts the certificate to DER format
  - Deletes the certificate
  correct_answer_index: 1
  explanation: This command displays the certificate in text format. The -text flag shows details like subject, issuer, validity dates, and public key. The -noout flag prevents showing the encoded certificate.
- type: mcq
  sequence_order: 6
  question: What error occurs when a certificate's Common Name (CN) or SAN doesn't match the hostname?
  options:
  - Certificate expired
  - Hostname mismatch
  - Untrusted CA
  - Invalid signature
  correct_answer_index: 1
  explanation: A hostname mismatch error occurs when the certificate's CN or Subject Alternative Name (SAN) doesn't match the domain you're connecting to. Browsers will show a security warning.
- type: mcq
  sequence_order: 7
  question: What is the recommended minimum RSA key size for certificates?
  options:
  - 512 bits
  - 1024 bits
  - 2048 bits
  - 8192 bits
  correct_answer_index: 2
  explanation: 2048-bit RSA keys are the current minimum recommended size. 4096-bit keys provide more security. Keys below 2048 bits are considered weak and should not be used.
- type: mcq
  sequence_order: 8
  question: How do you check when a remote server's certificate expires?
  options:
  - ping example.com
  - openssl s_client -connect example.com:443 | openssl x509 -noout -dates
  - curl example.com
  - nslookup example.com
  correct_answer_index: 1
  explanation: The s_client command connects to a server and retrieves its certificate. Piping to 'openssl x509 -noout -dates' extracts and displays the validity period (notBefore and notAfter dates).
- type: mcq
  sequence_order: 9
  question: What does the -nodes flag do in OpenSSL certificate generation?
  options:
  - Creates multiple certificates
  - Skips encrypting the private key (no DES)
  - Deletes old certificates
  - Connects to network nodes
  correct_answer_index: 1
  explanation: The -nodes flag means 'no DES' and creates an unencrypted private key. This is useful for automated processes but less secure. Encrypted keys require a passphrase.
- type: mcq
  sequence_order: 10
  question: Which curl flag ignores certificate validation errors (useful for testing only)?
  options:
  - -k or --insecure
  - -v or --verbose
  - -I or --head
  - -O or --output
  correct_answer_index: 0
  explanation: The -k or --insecure flag tells curl to skip certificate validation, allowing connections to sites with self-signed or expired certificates. This should ONLY be used for testing, never in production.
- type: terminal
  sequence_order: 11
  description: Generate a 2048-bit RSA private key named server.key
  command: openssl genrsa -out server.key 2048
  timeout_sec: 10
  validation:
    exit_code: 0
    files_created:
    - server.key
  hints:
  - Use 'openssl genrsa' to generate RSA keys
  - Specify output file with -out
  - Key size is the last parameter (2048)
- type: terminal
  sequence_order: 12
  description: View the contents of a certificate file named cert.pem in text format
  command: openssl x509 -in cert.pem -text -noout
  timeout_sec: 5
  validation:
    exit_code: 0
    output_contains:
    - "Certificate:"
  hints:
  - Use 'openssl x509' to work with certificates
  - The -text flag shows human-readable format
  - The -noout flag suppresses the encoded certificate
- type: terminal
  sequence_order: 13
  description: Check the validity dates (notBefore and notAfter) of cert.pem
  command: openssl x509 -in cert.pem -noout -dates
  timeout_sec: 5
  validation:
    exit_code: 0
    output_contains:
    - "notBefore"
    - "notAfter"
  hints:
  - Use 'openssl x509' command
  - The -dates flag shows validity period
  - Use -noout to suppress encoded output
- type: terminal
  sequence_order: 14
  description: Check the remote certificate of example.com on port 443
  command: echo | openssl s_client -connect example.com:443 -servername example.com 2>/dev/null | openssl x509 -noout -subject
  timeout_sec: 15
  validation:
    exit_code: 0
    output_contains:
    - "subject="
  hints:
  - Use 'openssl s_client' to connect to servers
  - Format is '-connect hostname:port'
  - The -servername flag is important for SNI
- type: terminal
  sequence_order: 15
  description: Convert a PEM certificate to DER format (cert.pem to cert.der)
  command: openssl x509 -in cert.pem -outform DER -out cert.der
  timeout_sec: 5
  validation:
    exit_code: 0
    files_created:
    - cert.der
  hints:
  - Use 'openssl x509' for conversion
  - Specify output format with -outform DER
  - Use -out to specify output filename
objectives:
- Understand the fundamental concepts and mechanisms of working with certificates
- Apply certificate management principles to solve real-world problems
- Identify key formats, tools, and certificate management behaviors
next_recommended: []

slug: lesson-5
title: Lesson 5
difficulty: easy
sequence_order: 5
estimated_minutes: 2
key_concepts: []
prerequisites: []
content_md: "# Microlesson \U0001F680\n\n# Storage & Persistence\n\n    Learn to provide\
  \ persistent storage for stateful applications in Kubernetes.\n\n    ## Volume Types\n\
  \n    **Ephemeral Volumes (Pod lifetime):**\n    - **emptyDir**: Temporary storage,\
  \ deleted when pod dies\n    - **configMap/secret**: Configuration mounted as volumes\n\
  \n    **Persistent Volumes (Beyond pod lifetime):**\n    - **hostPath**: Mount directory\
  \ from node filesystem\n    - **nfs**: Network File System mount\n    - **cloud\
  \ volumes**: AWS EBS, GCE PD, Azure Disk\n    - **csi**: Container Storage Interface\
  \ drivers\n\n    ## Persistent Volume (PV)\n\n    Cluster-level storage resource\
  \ provisioned by admin:\n    - Lifecycle independent of pods\n    - Can be statically\
  \ or dynamically provisioned\n    - Has capacity, access modes, and reclaim policy\n\
  \n    **Access Modes:**\n    - **ReadWriteOnce (RWO)**: Single node read-write\n\
  \    - **ReadOnlyMany (ROX)**: Multiple nodes read-only\n    - **ReadWriteMany (RWX)**:\
  \ Multiple nodes read-write\n\n    **Reclaim Policies:**\n    - **Retain**: Manual\
  \ reclamation\n    - **Delete**: Automatic deletion\n    - **Recycle**: Basic scrub\
  \ (deprecated)\n\n    ## Persistent Volume Claim (PVC)\n\n    User request for storage:\n\
  \    - Requests specific size and access modes\n    - Binds to available PV\n  \
  \  - Can specify StorageClass\n\n    ## Storage Classes\n\n    Dynamic provisioning\
  \ of storage:\n    - Define storage provisioner (AWS, GCE, etc.)\n    - Set parameters\
  \ (type, IOPS, replication)\n    - Enable automatic PV creation\n    - Support for\
  \ different storage tiers\n\n    ## Essential Commands\n\n    ```bash\n    # List\
  \ persistent volumes\n    kubectl get pv\n\n    # List persistent volume claims\n\
  \    kubectl get pvc\n\n    # Describe PVC\n    kubectl describe pvc my-pvc\n\n\
  \    # List storage classes\n    kubectl get storageclass\n    kubectl get sc\n\
  \    ```\n\n    Practice storage configuration in the labs!"
exercises:
- type: multiple_choice_question
  sequence_order: 1
  question: What is the main difference between emptyDir and PersistentVolume storage
    in Kubernetes?
  options:
  - emptyDir is faster than PersistentVolume
  - emptyDir data is deleted when the pod is removed while PersistentVolume data persists
    beyond pod lifecycle
  - PersistentVolume can only store text files while emptyDir can store any data
  - emptyDir requires a StorageClass while PersistentVolume does not
  correct_answer: emptyDir data is deleted when the pod is removed while PersistentVolume
    data persists beyond pod lifecycle
  explanation: 'The fundamental difference is data lifecycle: emptyDir volumes are
    ephemeral and exist only for the lifetime of the pod, with all data deleted when
    the pod is removed, while PersistentVolumes provide durable storage that persists
    independently of pod lifecycle. EmptyDir is created when a pod is assigned to
    a node and initially empty (hence the name), perfect for temporary scratch space,
    caching, or sharing data between containers in the same pod. When the pod is deleted,
    emptyDir data is permanently lost. PersistentVolumes, managed through PersistentVolumeClaims,
    survive pod deletions and can be reattached to new pods, making them essential
    for stateful applications like databases where data must persist. EmptyDir can
    be node disk-backed or memory-backed (tmpfs), while PersistentVolumes can use
    various backends (cloud disks, NFS, local storage). Neither has file type restrictions
    - both store any data. EmptyDir doesn''t require StorageClass (it''s created automatically),
    while PVCs can optionally specify a StorageClass for dynamic provisioning. Understanding
    when to use ephemeral versus persistent storage is crucial for application design
    - use emptyDir for temporary data and PersistentVolumes for data that must survive
    pod failures and updates.'
  require_pass: true
- type: multiple_choice_question
  sequence_order: 2
  question: What does the 'Retain' reclaim policy mean for a PersistentVolume?
  options:
  - The PV is automatically reused for new claims
  - The PV and its data are kept after the PVC is deleted, requiring manual cleanup
  - The PV is automatically deleted when the PVC is deleted
  - The PV data is backed up before deletion
  correct_answer: The PV and its data are kept after the PVC is deleted, requiring
    manual cleanup
  explanation: The Retain reclaim policy means that when a PersistentVolumeClaim is
    deleted, the PersistentVolume and all its data are preserved and marked as 'Released'
    (not available for new claims), requiring manual intervention for cleanup or reuse.
    This policy provides maximum data safety - if someone accidentally deletes a PVC,
    the data isn't lost and can be recovered. However, it also means administrators
    must manually handle cleanup, potentially leading to orphaned storage and ongoing
    costs if not managed properly. To reuse a Retained PV, you must manually delete
    or edit it to remove the claim reference. The Delete policy (default for dynamically
    provisioned volumes) automatically deletes both the PV and the underlying storage
    resource (like AWS EBS volume) when the PVC is deleted, providing automatic cleanup
    but risking data loss if deletion was accidental. The deprecated Recycle policy
    performed basic data scrubbing (rm -rf) and made the PV available again. For production
    databases or critical data, Retain is often preferred despite manual cleanup requirements,
    as it provides a safety net against accidental deletion. The reclaim policy doesn't
    create backups - you should implement separate backup strategies for important
    data.
  require_pass: true
- type: terminal
  sequence_order: 1
  command: kubectl get pv
  description: 'Practice the command: kubectl get pv'
  hints:
  - 'Try: kubectl get pv'
  - Use kubectl --help if you need help
  timeout_sec: 60
  require_pass: true
- type: terminal
  sequence_order: 2
  command: kubectl get pvc
  description: 'Practice the command: kubectl get pvc'
  hints:
  - 'Try: kubectl get pvc'
  - Use kubectl --help if you need help
  timeout_sec: 60
  require_pass: true
- type: mcq
  sequence_order: 3
  question: What command lists all pods in all namespaces?
  options:
  - kubectl get pods -A
  - kubectl list pods --all
  - kubectl get pods --everywhere
  - kubectl pods list -A
  correct_answer_index: 0
  explanation: kubectl get pods -A (or --all-namespaces) lists pods across all namespaces.
    The -A flag is shorthand for --all-namespaces.
  require_pass: true
